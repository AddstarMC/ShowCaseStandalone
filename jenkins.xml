<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project basedir="." name="ShowCaseStandalone">
    <property environment="env"/>
    <property name="debuglevel" value="source,lines,vars"/>
    <property name="target" value="1.6"/>
    <property name="source" value="1.6"/>
    
    <path id="ShowCaseStandalone.classpath">
        <fileset dir="lib">
            <include name="*.jar"/>
        </fileset>
    </path>
    
    <target name="init">
        <mkdir dir="bin"/>
        <mkdir dir="bin/classes"/>
        <mkdir dir="javadoc"/>
        
        <copy includeemptydirs="false" todir="bin/classes">
            <fileset dir="src">
                <exclude name="**/*.launch"/>
<!--                <exclude name="**/*.java"/> -->
            </fileset>
        </copy>
    </target>
    
    
    <target name="clean">
        <delete dir="bin"/>
        <delete dir="javadoc"/>
    </target>
    
    
    <target name="build-buildinfo">
        <tstamp>
            <format property="builtat" pattern="yyyy-MM-dd HH:mm:ss" timezone="Europe/Berlin"/>
        </tstamp>        
        <exec executable="svnversion" outputproperty="svnversion"/>
        <exec executable="whoami" outputproperty="whoami"/>
        <exec executable="uname" outputproperty="buildsystem"><arg value="-a"/></exec>
    
        <propertyfile file="bin/classes/build.properties"
            comment="This file is automatically generated - DO NOT EDIT">        
            <entry key="buildDate"         value="${builtat}"/>
            <entry key="buildNumber"     value="${env.BUILD_NUMBER}"/>
            <entry key="builder"         value="${whoami}"/>
        </propertyfile>
        
        <replaceregexp file="bin/classes/plugin.yml"
            match="version:[\s]([\d.]*)"
            replace="version: ${env.BUILD_NUMBER}"
            byline="true"
            />
    </target>
    
    
    
    <target depends="init,build-buildinfo" name="build-project">
        
        <javac debug="true" debuglevel="${debuglevel}" destdir="bin/classes" includeantruntime="false" source="${source}" target="${target}">
            <src path="src"/>
            <classpath refid="ShowCaseStandalone.classpath"/>
        </javac>
        
        <jar destfile="bin/ShowCaseStandalone.jar"
            basedir="bin/classes" 
            includes="**"/>
        
        
    </target>
    
    <target name="build-doc">
           <javadoc sourcepath="src" destdir="javadoc"  windowtitle="ShowCaseStandalone">
            <classpath refid="ShowCaseStandalone.classpath"/>
        </javadoc>
    </target>
    
</project>
